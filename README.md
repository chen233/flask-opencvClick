# flask-opencvClick 

## 项目概述
基于Flask和OpenCV的自动化操作工具，集成了图像识别、定时任务调度、数据处理等功能，通过Web界面实现可视化管理，支持多系统适配。

## 核心功能

### 1. 自动化操作与交互
- **跨系统粘贴适配**：自动识别操作系统（Windows/Linux/Mac），使用对应快捷键（Ctrl+V/Command+V）实现文本粘贴
- **窗口控制**：支持指定窗口置顶/取消置顶、关闭窗口等操作（通过窗口标题匹配）
- **图像识别交互**：基于OpenCV实现界面元素识别与自动点击（核心逻辑在 `opencv_button_click.py`）

### 2. 定时任务与系统管理
- **多组定时配置**：支持A/B组等多组任务的开始/停止时间设置
- **定时关机**：可配置自动关机时间，支持取消操作，适配多操作系统
- **任务调度**：通过APScheduler实现后台任务调度，确保定时任务准确执行

### 3. 数据处理与转换
- **文本转Excel**：将特定格式的TXT文件转换为Excel表格（`excelChange.py`）
- **日期解析与计算**：支持多种日期格式解析，自动计算时间差（天数）
- **数据增量更新**：Excel文件支持增量更新，保留历史数据并标记可编辑字段（红色文字）和自动计算字段（绿色文字）

### 4. Web管理界面
- 提供直观的Web界面（`templates/index.html`），可配置定时任务时间
- 实时查看系统运行日志和状态信息
- 控制工作流启动/停止、配置定时关机等操作

### 5. 授权与安全
- 包含授权验证机制，支持试用期管理和激活功能
- 通过加密算法保护授权文件，防止篡改

## 启动方式
1. **环境安装**
   首次使用时，点击 `首次安装点击我.bat` 自动安装所需依赖包
2. **程序启动**
   点击 `start_FK.bat` 启动应用程序，程序会自动启动Flask Web服务
3. **访问管理界面**
   - 打开浏览器访问 `127.0.0.1:5000`
   - 或通过提供的"工作流网址"直接打开

## 主要模块说明

| 文件名                     | 功能说明                                                        |
|---------------------------|-----------------------------------------------------------------|
| `FK.py`                   | Flask Web服务主体，包含路由、定时任务调度、授权验证等核心逻辑 |
| `opencv_button_click.py`  | 基于OpenCV的图像识别与自动化操作实现                           |
| `excelChange.py`         | TXT文件转Excel及数据处理逻辑                                   |
| `templates/index.html`    | Web管理界面HTML模板                                            |

## 注意事项
- 支持Windows、Linux、Mac多操作系统
- 数据文件（如TXT、Excel）默认存储在桌面相关目录
- 程序运行状态和配置信息保存在 `status.json`，日志记录在 `log.txt`
